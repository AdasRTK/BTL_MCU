/*
 * fsm_automatic.c
 *
 *  Created on: Oct 28, 2023
 *      Author: Admin
 */

#include "fsm_automatic.h"

void fsm_automatic_run(){
	switch(status) {
		case INIT:
			status = RED_GREEN;
			HAL_GPIO_WritePin(LED_RED_HORI_GPIO_Port, LED_RED_HORI_Pin, SET);
			HAL_GPIO_WritePin(LED_GREEN_HORI_GPIO_Port, LED_GREEN_HORI_Pin, SET);
			setTimer(100, 0);
			break;
		case RED_GREEN:
			//HAL_GPIO_TogglePin(LED_GREEN_HORI_GPIO_Port, LED_GREEN_HORI_Pin);
			HAL_GPIO_WritePin(LED_RED_HORI_GPIO_Port, LED_RED_HORI_Pin, RESET);
			HAL_GPIO_WritePin(LED_GREEN_HORI_GPIO_Port, LED_GREEN_HORI_Pin, RESET);
			if(timer_flag[0] == 1){
				setTimer(100, 0);
				status = RED_YELLOW;
			}
			break;
		case RED_YELLOW:
			if(timer_flag[0] == 1){
				setTimer(100, 0);
				status = GREEN_RED;
			}
			break;
		case GREEN_RED:
			if(timer_flag[0] == 1){
				setTimer(100, 0);
				status = GREEN_YELLOW;
			}
			break;
		case GREEN_YELLOW:

			if(timer_flag[0] == 1){
				setTimer(100, 0);
				status = RED_GREEN;
			}
			break;
		default:
			break;
	}
};

